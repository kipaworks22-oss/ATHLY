<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ATHLY Î² | KBO ì„ ìˆ˜ ì—°ë™</title>

  <!-- Tailwind (CDN â€” ê°œë°œìš©) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    body { background:#f9f9f9; color:#111; }
    .card { background:white; border-radius:1rem; padding:1.5rem; box-shadow:0 2px 8px rgba(0,0,0,0.05); }
    .btn { background:black; color:white; border-radius:9999px; padding:0.5rem 1rem; }
    .btn:hover { opacity:0.8; }
  </style>
</head>

<body class="min-h-screen flex flex-col items-center py-10">
  <main class="w-full max-w-xl">

    <h1 class="text-3xl font-bold mb-2">ATHLY Î²</h1>
    <p class="text-gray-500 mb-6">ì—°ê²°ë¨ Â· ì‹¤ì œ KBO ì„ ìˆ˜ ì—°ë™</p>

    <div class="flex gap-2 mb-6">
      <button class="btn">í™ˆ</button>
      <button class="btn">ê²½ê¸°ê¸°ë¡</button>
      <button class="btn">ë¶ˆíœ</button>
      <button class="btn">ìš´ë™</button>
      <button class="btn">ë¦¬í¬íŠ¸</button>
      <button class="btn bg-black text-white">KBOì—°ë™</button>
    </div>

    <section class="card">
      <h2 class="text-xl font-semibold mb-2">KBO ì„ ìˆ˜ ì—°ê²°</h2>
      <p class="text-gray-500 mb-4">ì„ ìˆ˜ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•˜ê³  ì„ íƒí•˜ë©´ ì—°ê²°ë©ë‹ˆë‹¤.</p>

      <div class="flex gap-2 mb-3">
        <input type="text" id="playerName" class="flex-1 border rounded-full px-4 py-2" placeholder="ì˜ˆ: ë°•ì£¼ì„±, ê¹€ì„±ë¯¼ ë“±" />
        <button id="searchBtn" class="btn">ê²€ìƒ‰</button>
      </div>

      <div id="results" class="text-sm text-gray-700">
        <em>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</em>
      </div>
    </section>
  </main>

  <script>
    // ğŸŒ ë°±ì—”ë“œ ì£¼ì†Œ (Cloudflare Workers)
    window.ATHLY_CONFIG = {
      BACKEND_BASE: "https://athly.kipaworks22.workers.dev"
    };

    // âš™ï¸ ê²€ìƒ‰ ê¸°ëŠ¥
    (function () {
      const base = window.ATHLY_CONFIG.BACKEND_BASE;
      const input = document.getElementById('playerName');
      const btn = document.getElementById('searchBtn');
      const box = document.getElementById('results');

      async function render(q) {
        const name = (q ?? input.value ?? '').trim();
        const url = `${base}/kbo/search${name ? `?name=${encodeURIComponent(name)}` : ''}`;
        try {
          const res = await fetch(url);
          const data = await res.json();

          if (data.players && data.players.length > 0) {
            box.innerHTML = data.players.map(p => `
              <div class="p-3 border border-gray-200 rounded-lg mb-2">
                <b>${p.name}</b> <span class="text-gray-500">(${p.position})</span><br/>
                <span class="text-gray-400 text-sm">${p.team} Â· ID: ${p.id}</span>
              </div>
            `).join('');
          } else {
            box.innerHTML = '<em>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</em>';
          }
        } catch (err) {
          console.error(err);
          box.innerHTML = '<em class="text-red-500">ì—°ê²° ì˜¤ë¥˜</em>';
        }
      }

      // ì´ë²¤íŠ¸
      btn.addEventListener('click', () => render());
      input.addEventListener('keydown', e => { if (e.key === 'Enter') render(); });

      // í˜ì´ì§€ ì§„ì… ì‹œ í‚¤ì›€ ì „ì²´ ìë™ ë¡œë“œ
      render('í‚¤ì›€');
    })();
  </script>
</body>
</html>
